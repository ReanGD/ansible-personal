---
- name: Base install home assistant
  hosts: hass
  gather_facts: false
  pre_tasks:
    - import_tasks: tasks/common/init_facts.yml
      vars:
        is_chroot_param: False
  roles:
    - locale
    - users
    - network
    - packages_manager
    - ssh
    - swap
    - systemd_configure
    - role: time
      when: not is_chroot
    - role: font
      when: '"font" in roles.split(",")'
    - role: audio
      when: '"audio" in roles.split(",")'
    - role: docker
      when: '"docker" in roles.split(",")'
    - role: automount
      when: '"automount" in roles.split(",")'
    - role: rsync_server
      when: '"rsync_server" in roles.split(",")'
    - role: hass
      when: '"hass" in roles.split(",")'
    - role: hass_update
      when: '"hass" in roles.split(",")'
    - role: monitoring
      when: monitoring!="none"
    - role: packages
      when: not is_chroot
    - role: pkgcacheclean
      when: x86_64
    - role: repository
      when: 'not is_chroot and "repository" in roles.split(",")'
    - role: dotfiles
      when: x86_64
    - role: gui
      when: not is_chroot and gui!="none"
    - role: vs_code
      when: not is_chroot and develop!="none"
    - clear
